!function(t){if(!t.SUBMODULES_VERSION){t.SUBMODULES_VERSION="1.0.0",t.SUBMODULES_VERNUM=0,t.namespaces={};class e{}class r{}t.require=function(e){return n(e),t.namespaces[e]},t.namespace=function(e,a){n(e);var o=new r;for(var s in a(o),o)t.namespaces[e][s]=o[s]}}function n(n){n in t.namespaces||(t.namespaces[n]=new e)}}(this),namespace("com.subnodal.subelements",(function(e){var t=require("com.subnodal.subelements.evaluator"),n=require("com.subnodal.subelements.l10n");e.VERSION="1.0.0",e.VERNUM=0,e.NO_REPEAT=-1,e.rootElement=null,e.scope=null,e.render=function(n=e.rootElement){document.body.hidden=!1,t.evaluateTree(n,e.scope)},e.ready=function(e){"complete"==document.readyState?e():addEventListener("load",e)},e.init=function(t){t=t||{},n.loadLanguageResources(t.languageResources||n.languageResources),n.switchToLocale(t.localeCode||n.getSystemLocale()),n.setFallbackLocale(t.fallbackLocaleCode||n.getSystemLocale()),e.ready((function(){e.silent||console.log(`%c{%csubElements%c}%c\nhttps://github.com/Subnodal/subElements | V${e.VERSION} | Ready!`,'font-size: 1.5em; font-family: "Overpass Mono", monospace;',"font-size: 1.5em; font-weight: bold;","font-size: 1.5em; font-weight: normal;",""),e.rootElement=t.rootElement||document.body,e.scope=t.scope||window,null==t.textDirection||"auto"==t.textDirection?document.body.setAttribute("dir",n.getLocaleTextDirection()):document.body.setAttribute("dir",t.textDirection),e.render()}))}})),namespace("com.subnodal.subelements.core",(function(e){e.parameter=function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null},e.generateKey=function(e=16,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"){for(var n="",r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}})),namespace("com.subnodal.subelements.evaluator",(function(exports){var l10n=require("com.subnodal.subelements.l10n"),requests=require("com.subnodal.subelements.requests"),lastEvaluatedCondition=!0;function evalWithScope(expression,scope={...window}){with(scope)return eval(expression)}exports.evaluateExpression=function(e,t={...window}){return e.replace(/{{(.*?)}}/g,(function(e,n){return evalWithScope(n,t)}))},exports.evaluateTree=function(e=document.body,t={...window},n=!0){var r=!0;if(document.body.setAttribute("lang",l10n.getLocaleCode().length>5?l10n.getLocaleCode().replace(/_/g,"-"):l10n.getLocaleCode().substring(0,2)),document.body.setAttribute("dir",l10n.getLocaleTextDirection()),e.scope=t,e.nodeType==Node.TEXT_NODE){if(null!=e.s_textContent&&e.textContent!=e.s_textContent&&e.textContent?e.textContent=e.s_textContent:e.s_textContent=e.textContent,e.textContent.match(/{{(.*?)}}/g)&&(e.textContent=exports.evaluateExpression(e.textContent,t)),n&&("yes"==e.parentElement.getAttribute("translate")||""==e.parentElement.getAttribute("translate"))){for(var a=e.textContent.trim().split("|").slice(1),o={},s=0;s<a.length;s++){var l,u;a[s].split(":").length>1?(l=a[s].split(":")[0],u=a[s].split(":").slice(1).join(":")):(l=s,u=a[s]),isNaN(u)||(u=Number(u)),o[l]=u}e.textContent=l10n.translate(e.textContent.trim().split("|")[0],o)}}else if(e.nodeType!=Node.COMMENT_NODE){if("yes"==e.getAttribute("s-ignore")||""==e.getAttribute("s-ignore"))return;for(s=0;s<e.attributes.length;s++){var i=e.attributes[s];null!=i.s_value&&i.value!=i.s_value?i.value=i.s_value:i.s_value=i.value,i.value.match(/{{(.*?)}}/g)&&(i.value=exports.evaluateExpression(i.value,t))}if(e.getAttribute("s-import")&&(t[e.getAttribute("s-error")]=null,requests.get(e.getAttribute("s-import")).then((function(r){e.innerHTML=r,t[e.getAttribute("s-status")]=status,setTimeout((function(){exports.evaluateTree(e,t,n)}))})).catch((function(r){e.getAttribute("s-error")||e.getAttribute("s-status")||console.error(`Received uncaught error when importing: ${r.code} ${r.message}`),t[e.getAttribute("s-status")]=r.code,t[e.getAttribute("s-error")]=r.message,setTimeout((function(){exports.evaluateTree(e,t,n)}))})),e.removeAttribute("s-import"),e.getAttribute("s-status")?t[e.getAttribute("s-status")]=0:r=!1),e.getAttribute("s-request")&&(t[e.getAttribute("s-error")]=null,requests.get(e.getAttribute("s-request")).then((function(r,a){if("json"==e.getAttribute("s-as"))try{t[e.getAttribute("s-response")]=JSON.parse(r)}catch(n){e.getAttribute("s-error")||e.getAttribute("s-status")?t[e.getAttribute("s-error")]={code:a,message:"Syntax error when parsing JSON"}:console.error(`Received uncaught error when making request: ${a} Syntax error when parsing JSON`)}else t[requestVariable]=r;t[e.getAttribute("s-status")]=a,setTimeout((function(){exports.evaluateTree(e,t,n)}))})).catch((function(r){e.getAttribute("s-error")||e.getAttribute("s-status")||console.error(`Received uncaught error when making request: ${r.code} ${r.message}`),t[e.getAttribute("s-status")]=r.code,t[e.getAttribute("s-error")]=r.message,setTimeout((function(){exports.evaluateTree(e,t,n)}))})),e.removeAttribute("s-request"),e.getAttribute("s-status")?t[e.getAttribute("s-status")]=0:r=!1),"S-IF"==e.tagName)null==(c=e.getAttribute("condition"))&&(c="false"),"true"==c?(e.hidden=!1,lastEvaluatedCondition=!0,r=!0):(e.hidden=!0,lastEvaluatedCondition=!1,r=!1);else if("S-ELSEIF"==e.tagName){var c;null==(c=evalWithScope(e.getAttribute("condition")))&&(c="false"),lastEvaluatedCondition?(e.hidden=!0,r=!1):"true"==c?(e.hidden=!1,lastEvaluatedCondition=!0,r=!0):(e.hidden=!0,lastEvaluatedCondition=!1,r=!1)}else if("S-ELSE"==e.tagName)lastEvaluatedCondition?(e.hidden=!0,r=!1):(e.hidden=!1,r=!0);else if("S-FOR"==e.tagName){null==e.s_innerHTML&&(e.s_innerHTML=e.innerHTML),e.s_start==evalWithScope(e.getAttribute("start")||"",t)&&e.s_stop==evalWithScope(e.getAttribute("stop")||"",t)&&e.s_step==evalWithScope(e.getAttribute("step")||"",t)||(e.s_start=evalWithScope(e.getAttribute("start")||"",t),e.s_stop=evalWithScope(e.getAttribute("stop")||"",t),e.s_step=evalWithScope(e.getAttribute("step")||"",t)),e.innerHTML="",r=!1;var g=0;for(s=Number(e.s_start);s<Number(e.s_stop);s+=Number(e.s_step)||1){e.getAttribute("var")&&(t[e.getAttribute("var")]=s),e.innerHTML+=e.s_innerHTML;for(var p=g;p<e.childNodes.length;p++)exports.evaluateTree(e.childNodes[p],t,!1);g=e.childNodes.length}}else if("S-EACH"==e.tagName){null==e.s_innerHTML&&(e.s_innerHTML=e.innerHTML),e.s_in!=evalWithScope(e.getAttribute("in")||"",t)&&(e.s_in=evalWithScope(e.getAttribute("in")||"",t)),e.innerHTML="",r=!1;for(g=0,s=0;s<Object.keys(e.s_in).length;s++){e.getAttribute("itervar")&&(t[e.getAttribute("itervar")]=s),e.getAttribute("keyvar")&&(t[e.getAttribute("keyvar")]=Object.keys(e.s_in)[s]),e.getAttribute("valuevar")&&(t[e.getAttribute("valuevar")]=e.s_in[Object.keys(e.s_in)[s]]),e.innerHTML+=e.s_innerHTML;for(p=g;p<e.childNodes.length;p++)exports.evaluateTree(e.childNodes[p],t,!1);g=e.childNodes.length}}else"S-SET"==e.tagName&&(t[e.getAttribute("var")]=evalWithScope(e.getAttribute("value")||"",t))}if(r)for(s=0;s<e.childNodes.length;s++)exports.evaluateTree(e.childNodes[s],t)}})),namespace("com.subnodal.subelements.l10n",(function(exports){const DEFAULT_FORMATTING_LOCALE="en_GB";var warnedStrings=[];function warnString(e,t){warnedStrings.includes(e)||(console.warn(t),warnedStrings.push(e))}exports.languageResources={},exports.localeCode=null,exports.fallbackLocaleCode=null,exports.loadLanguageResource=function(e,t){exports.languageResources[e]=t},exports.loadLanguageResources=function(e){exports.languageResources=e},exports.switchToLocale=function(e){exports.localeCode=e},exports.getLocaleCode=function(){return exports.localeCode},exports.setFallbackLocale=function(e){exports.fallbackLocaleCode=e},exports.getSystemLocale=function(){var e=navigator.language;return null!=navigator.languages&&(e=navigator.languages[0]),e.split("-")[0]+"_"+e.split("-")[1]},exports.formatValue=function(e,t={},n=exports.localeCode){return"number"==typeof e?Number(e).toLocaleString((n||DEFAULT_FORMATTING_LOCALE).replace(/_/g,"-"),t):e instanceof Date?e.toLocaleString(t).replace(/_/g,"-"):e},exports.getLanguageResourceCodes=function(){return Object.keys(exports.languageResources)},exports.getLocaleName=function(e=exports.localeCode,t=!1){return t&&exports.languageResources[e].nameShort||exports.languageResources[e].name},exports.getLocaleTextDirection=function(e=exports.localeCode){return null!=exports.languageResources[e]?exports.languageResources[e].textDirection:null!=exports.languageResources[exports.fallbackLocaleCode]?exports.languageResources[exports.fallbackLocaleCode].textDirection:"ltr"},exports.translate=function(string,arguments,formatValues=!0,formatValueOptions={},localeCode=exports.localeCode){"object"!=typeof arguments&&(arguments=[arguments]);var translatedString="";if(null!=exports.languageResources[localeCode]&&null!=exports.languageResources[localeCode].strings[string])translatedString=exports.languageResources[localeCode].strings[string];else{if(null==exports.languageResources[exports.fallbackLocaleCode])throw new ReferenceError("Tried to use fallback locale, but fallback locale does not exist");warnString(string,`Fallback locale is in use to translate string "${string}"`),translatedString=exports.languageResources[exports.fallbackLocaleCode].strings[string]}if(null!=translatedString){var foundTranslation=null;if("object"==typeof translatedString)for(var rule in rules){var ruleTemplate=rule;for(var argument in arguments){var argumentReplacement=arguments[argument];formatValues&&(argumentReplacement=exports.formatValue(argumentReplacement,formatValueOptions,localeCode)),argumentReplacement=argumentReplacement.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rule=rule.replace(new RegExp("\\{"+argument+"\\}","g"),"`"+argumentReplacement+"`"),eval(rule)&&(foundTranslation=rules[ruleTemplate])}}else foundTranslation=translatedString;if(null!=foundTranslation){for(var argument in arguments)formatValues&&(arguments[argument]=exports.formatValue(arguments[argument],formatValueOptions,localeCode)),foundTranslation=foundTranslation.replace(new RegExp("\\{"+argument+"\\}","g"),arguments[argument]);return foundTranslation}warnString(string,`String "${string}" has no precise translation`)}else warnString(string,`String "${string}" has no translation`)}})),namespace("com.subnodal.subelements.requests",(function(e){e.make=function(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;a.onload=function(){200==a.status?n(a.response,a.status):r({code:a.status,message:a.response})},a.open(e,t,!0),a.send()}))},e.get=function(t){return e.make("GET",t)},e.getJson=function(t){return new Promise((function(n,r){e.get(t).then((function(e,t){try{n(JSON.parse(e),t)}catch(e){if(!(e instanceof SyntaxError))throw e;r({code:t,message:"Syntax error when parsing JSON"})}})).catch((function(e){r(e)}))}))}}));