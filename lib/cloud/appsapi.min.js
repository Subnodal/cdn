(function(n){if(n.SUBMODULES_VERSION){return}n.SUBMODULES_VERSION="1.0.0";n.SUBMODULES_VERNUM=0;n.namespaces={};class e{}class a{}function s(a){if(!(a in n.namespaces)){n.namespaces[a]=new e}}n.require=function(e){s(e);return n.namespaces[e]};n.namespace=function(e,c){s(e);var i=new a;c(i);for(var r in i){n.namespaces[e][r]=i[r]}}})(this);namespace("com.subnodal.cloud.appsapi",(function(t){var e=require("com.subnodal.cloud.appsapi.revisions");t.rootElement=null,t.bridgeEmbed=null,t.bridgeHostUrl=null,t.manifest={},t.bridgeResponses={},t.readyCallbacks=[];var n=null;t.applyBridgeStyling=function(){t.bridgeEmbed.setAttribute("style",`\n            all: initial;\n            position: fixed;\n            display: none;\n            top: 0;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            width: 100vw;\n            height: 100vh;\n            height: -webkit-fill-available;\n            margin: 0;\n            padding: 0;\n            border: 0;\n            z-index: ${Math.pow(2,32)/2-1};\n        `)},t.showBridge=function(){t.bridgeEmbed.style.display="block"},t.hideBridge=function(){t.bridgeEmbed.style.display="none"},t.attachBridge=function(){t.bridgeEmbed=document.createElement("iframe"),t.bridgeEmbed.src=t.bridgeHostUrl,window.addEventListener("message",(function(e){if(e.origin==new URL(t.bridgeHostUrl).origin)switch(e.data?.type){case"sendManifest":return void t.sendBridgeEventDescriptor("setManifest",t.manifest);case"ready":return void t.readyCallbacks.forEach((t=>t()));case"response":return void(t.bridgeResponses[e.data?.eventToken]=e.data.data);case"show":return null==n&&(n=document.activeElement),void t.showBridge();case"hide":return t.hideBridge(),void(n instanceof Node&&(n.focus(),n=null));default:return void console.warn("Unknown response type:",e.data?.type)}})),t.applyBridgeStyling(),t.rootElement.append(t.bridgeEmbed)},t.sendBridgeEventDescriptor=function(e,n={}){return new Promise((function(r,i){var o=String((new Date).getTime()),s=setInterval((function(){if(t.bridgeResponses.hasOwnProperty(o)){clearInterval(s);var e=t.bridgeResponses[o];delete t.bridgeResponses[o],("ok"==e?.status?r:i)(e)}}));t.bridgeEmbed.contentWindow.postMessage({eventDescriptor:e,data:n,eventToken:o},new URL(t.bridgeHostUrl).origin)}))},t.Revision=class{constructor(t=null,e=new Date){this.lastModified=e,this.changes=[],this.author=t}assignData(t,n){this.changes=e.diffObjectPaths(e.deflateObject(t),e.deflateObject(n)),this.lastModified=new Date}applyData(t){return e.inflateObject(e.applyDiffToObjectPaths(e.deflateObject(t),this.changes))}get timestamp(){return this.lastModified.getTime()}serialise(){return{changes:this.changes,author:this.author}}static deserialise(t,e){var n=new this(e.author,new Date(t));return n.changes=e.changes,n}},t.CollaborativeDocument=class{constructor(e={}){var n=new t.Revision;n.assignData({},e),this.objectKey=null,this.revisions=[n,new t.Revision],this.mergeSettled=!1}get previousRevision(){return this.revisions[this.revisions.length-2]||null}get currentRevision(){return this.revisions[this.revisions.length-1]}buildDataToRevision(t){var e={};return this.revisions.slice(0,t+1).forEach((function(t){e=t.applyData(e)})),e}get dataBeforeChanges(){return this.buildDataToRevision(this.revisions.length-2)}get data(){return this.buildDataToRevision(this.revisions.length-1)}set data(t){this.currentRevision.assignData(this.dataBeforeChanges,t)}get hasUnsavedChanges(){return this.currentRevision.changes.length>0}cleanRevisions(){this.revisions=this.revisions.filter(((t,e)=>0==e||t.changes.length>0))}serialise(){var t={};return this.revisions.forEach((function(e){t[String(Math.floor(e.timestamp))]=e.serialise()})),{revisions:t}}static deserialise(e){var n=new this({});return n.revisions=Object.keys(e.revisions||{}).map((function(n){return t.Revision.deserialise(Number(n),e.revisions[n])})),n}static readRevisionData(e){return t.readFile(e).then((function(t){var e={};if(0!=t.data.byteLength)try{e=BSON.deserialize(t.data)}catch(t){return Promise.reject({status:"error",result:"badFormatting",message:"The read document has bad formatting"})}return e.revisions||={},Promise.resolve(e)}))}open(t=this.objectKey,n=!1){var r=this;return this.objectKey=t,this.constructor.readRevisionData(t).then((function(t){var i={...t};return n&&e.merge(t,r.serialise()),r.mergeSettled=JSON.stringify(i)==JSON.stringify(t),r.revisions=r.constructor.deserialise(t).revisions,Promise.resolve({status:"ok",result:"opened",data:r.data})}))}save(e=this.objectKey){var n=this;return null==e?Promise.reject({status:"error",result:"precondition",message:"The object key has not yet been assigned"}):(this.cleanRevisions(),t.getUid().then((function(t){return n.revisions.forEach((function(e){null==e.author&&(e.author=t.uid)})),n.open(e,!0)})).then((function(){return t.writeFile(e,BSON.serialize(n.serialise()))})).then((function(){return n.revisions.push(new t.Revision),Promise.resolve({status:"ok",result:"saved"})})))}sync(){var t=this;return null==this.objectKey?Promise.reject({status:"error",result:"precondition",message:"This document has not yet been saved"}):this.open(this.objectKey,!0).then((function(){return t.mergeSettled?Promise.resolve({status:"ok",result:"noActionTaken"}):this.save(this.objectKey)}))}},t.getLocaleCode=function(){return t.sendBridgeEventDescriptor("getLocale")},t.setLocaleCode=function(e){return t.sendBridgeEventDescriptor("setLocale",{localeCode:e})},t.getUid=function(){return t.sendBridgeEventDescriptor("getUid")},t.showSaveFileDialog=function(e){return t.sendBridgeEventDescriptor("showSaveFileDialog",{name:e})},t.showOpenFileDialog=function(e=(t.manifest.associations?.length>0?t.manifest.associations.map((t=>t.extension)):null)){return t.sendBridgeEventDescriptor("showOpenFileDialog",{filterExtensions:e})},t.readFile=function(e){return t.sendBridgeEventDescriptor("readFile",{key:e})},t.writeFile=function(e,n){return ArrayBuffer.isView(n)?n=n.buffer:n instanceof ArrayBuffer||(n=(new TextEncoder).encode(String(n)).buffer),t.sendBridgeEventDescriptor("writeFile",{key:e,data:n})},t.init=function(e={}){t.rootElement=e.rootElement||document.body,t.bridgeHostUrl=e.bridgeHostUrl||"https://cloud.subnodal.com/embed.html",t.manifest={suggestedOpenUrl:e.openUrl||window.location.href,associations:(e.associations||[]).map((t=>({extension:t.extension,openUrl:e.openUrl||window.location.href,namingScheme:{appName:e.appName,appNameShort:e.appNameShort||e.appName,documentTypeName:t.documentTypeName,fallbackLocaleCode:e.fallbackLocaleCode},thumbnailUrl:t.thumbnailUrl,creatable:0!=t.creatable})))},t.attachBridge()},t.ready=function(e){t.readyCallbacks.push(e)}})),namespace("com.subnodal.cloud.appsapi.internal",(function(t){var e=require("com.subnodal.cloud.appsapi");t.configGetSetting=function(t,n=null,r=null){return e.sendBridgeEventDescriptor("configGetSetting",{setting:t}).then((function(t){return null!=n&&typeof t.data!=n?Promise.resolve({status:"ok",result:"fallback",data:r}):Promise.resolve(t)}))},t.configSetSetting=function(t,n){return e.sendBridgeEventDescriptor("configSetSetting",{setting:t,data:n})}})),namespace("com.subnodal.cloud.appsapi.revisions",(function(t){t.merge=function(t,e){Object.keys(e.revisions).forEach((function(n){t.revisions[n]=e.revisions[n]}))},t.deflateObject=function(e){var n=[];return"object"==typeof e?Object.keys(e).forEach((function(r){t.deflateObject(e[r]).forEach((function(t){n.push({path:[r,...t.path],data:t.data})}))})):n.push({path:[],data:e}),n},t.inflateObject=function(e){for(var n={},r={},i=0;i<e.length;i++){if(0==e[i].path.length)return e[i].data;var o=e[i].path[0],s={path:e[i].path.slice(1),data:e[i].data};r.hasOwnProperty(o)?r[o].push(s):r[o]=[s]}return Object.keys(r).forEach((function(e){n[e]=t.inflateObject(r[e])})),n},t.diffObjectPaths=function(t,e){var n=[];return t.forEach((function(t){var r=JSON.stringify(t.path);null==e.find((t=>JSON.stringify(t.path)==r))&&n.push({path:t.path,remove:!0})})),e.forEach((function(e){var r=JSON.stringify(e.path),i=t.find((t=>JSON.stringify(t.path)==r));null!=i&&i.data==e.data||n.push(e)})),n},t.applyDiffToObjectPaths=function(t,e){var n=[],r=[];return e.forEach((function(t){t.remove&&r.push(JSON.stringify(t.path))})),t.forEach((function(t){r.includes(JSON.stringify(t.path))||n.push(t)})),e.forEach((function(t){if(!t.remove){var e=JSON.stringify(t.path),r=n.findIndex((t=>JSON.stringify(t.path)==e));r>=0?n[r]=t:n.push(t)}})),n}}));var BSON=function(t){"use strict";for(var e=function(t){var e=h(t),n=e[0],r=e[1];return 3*(n+r)/4-r},n=function(t){var e,n,r=h(t),i=r[0],u=r[1],f=new s(function(t,e,n){return 3*(e+n)/4-n}(0,i,u)),a=0,l=u>0?i-4:i;for(n=0;n<l;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],f[a++]=e>>16&255,f[a++]=e>>8&255,f[a++]=255&e;2===u&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,f[a++]=255&e);1===u&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,f[a++]=e>>8&255,f[a++]=255&e);return f},r=function(t){for(var e,n=t.length,r=n%3,o=[],s=16383,u=0,f=n-r;u<f;u+=s)o.push(l(t,u,u+s>f?f:u+s));1===r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return o.join("")},i=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,a=u.length;f<a;++f)i[f]=u[f],o[u.charCodeAt(f)]=f;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var r,o,s=[],u=e;u<n;u+=3)r=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(255&t[u+2]),s.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63;var c,p={byteLength:e,toByteArray:n,fromByteArray:r},g=function(t,e,n,r,i){var o,s,u=8*i-r-1,f=(1<<u)-1,a=f>>1,h=-7,l=n?i-1:0,c=n?-1:1,p=t[e+l];for(l+=c,o=p&(1<<-h)-1,p>>=-h,h+=u;h>0;o=256*o+t[e+l],l+=c,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+l],l+=c,h-=8);if(0===o)o=1-a;else{if(o===f)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=a}return(p?-1:1)*s*Math.pow(2,o-r)},y=function(t,e,n,r,i,o){var s,u,f,a=8*o-i-1,h=(1<<a)-1,l=h>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,g=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-s))<1&&(s--,f*=2),(e+=s+l>=1?c/f:c*Math.pow(2,1-l))*f>=2&&(s++,f/=2),s+l>=h?(u=0,s=h):s+l>=1?(u=(e*f-1)*Math.pow(2,i),s+=l):(u=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&u,p+=g,u/=256,i-=8);for(s=s<<i|u,a+=i;a>0;t[n+p]=255&s,p+=g,s/=256,a-=8);t[n+p-g]|=128*y},d=(function(t,e){var n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},e.INSPECT_MAX_BYTES=50;var r=2147483647;function i(t){if(t>r)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return f(t)}return s(t,e,n)}function s(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|c(t,e),r=i(n),s=r.write(t,e);return s!==n&&(r=r.slice(0,s)),r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(J(t,Uint8Array)){var e=new Uint8Array(t);return h(e.buffer,e.byteOffset,e.byteLength)}return a(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t));if(J(t,ArrayBuffer)||t&&J(t.buffer,ArrayBuffer))return h(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(J(t,SharedArrayBuffer)||t&&J(t.buffer,SharedArrayBuffer)))return h(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return o.from(r,e,n);var s=function(t){if(o.isBuffer(t)){var e=0|l(t.length),n=i(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||Y(t.length)?i(0):a(t):"Buffer"===t.type&&Array.isArray(t.data)?a(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t))}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return u(t),i(t<0?0:0|l(t))}function a(t){for(var e=t.length<0?0:0|l(t.length),n=i(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function h(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,o.prototype),r}function l(t){if(t>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|t}function c(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||J(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(t));var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return P(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return k(t).length;default:if(i)return r?-1:P(t).length;e=(""+e).toLowerCase(),i=!0}}function d(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return N(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return U(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function b(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,s=1,u=t.length,f=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,u/=2,f/=2,n/=2}function a(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(o=n;o<u;o++)if(a(t,o)===a(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===f)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(n+f>u&&(n=u-f),o=n;o>=0;o--){for(var l=!0,c=0;c<f;c++)if(a(t,o+c)!==a(e,c)){l=!1;break}if(l)return o}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var u=parseInt(e.substr(2*s,2),16);if(Y(u))return s;t[n+s]=u}return s}function S(t,e,n,r){return C(P(e,t.length-n),t,n,r)}function E(t,e,n,r){return C(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function O(t,e,n,r){return C(k(e),t,n,r)}function B(t,e,n,r){return C(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function _(t,e,n){return 0===e&&n===t.length?p.fromByteArray(t):p.fromByteArray(t.slice(e,n))}function N(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,u,f,a=t[i],h=null,l=a>239?4:a>223?3:a>191?2:1;if(i+l<=n)switch(l){case 1:a<128&&(h=a);break;case 2:128==(192&(o=t[i+1]))&&(f=(31&a)<<6|63&o)>127&&(h=f);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(f=(15&a)<<12|(63&o)<<6|63&s)>2047&&(f<55296||f>57343)&&(h=f);break;case 4:o=t[i+1],s=t[i+2],u=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&u)&&(f=(15&a)<<18|(63&o)<<12|(63&s)<<6|63&u)>65535&&f<1114112&&(h=f)}null===h?(h=65533,l=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=l}return function(t){var e=t.length;if(e<=x)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=x));return n}(r)}e.kMaxLength=r,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,n){return s(t,e,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?i(t):void 0!==e?"string"==typeof n?i(t).fill(e,n):i(t).fill(e):i(t)}(t,e,n)},o.allocUnsafe=function(t){return f(t)},o.allocUnsafeSlow=function(t){return f(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(J(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),J(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(J(s,Uint8Array))i+s.length>r.length?o.from(s).copy(r,i):Uint8Array.prototype.set.call(r,s,i);else{if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i)}i+=s.length}return r},o.byteLength=c,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?N(this,0,t):d.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(t,e,n,r,i){if(J(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(t));if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),u=(n>>>=0)-(e>>>=0),f=Math.min(s,u),a=this.slice(r,i),h=t.slice(e,n),l=0;l<f;++l)if(a[l]!==h[l]){s=a[l],u=h[l];break}return s<u?-1:u<s?1:0},o.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},o.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return S(this,t,e,n);case"ascii":case"latin1":case"binary":return E(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function U(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function I(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=z[t[o]];return i}function j(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,n,r,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,i){return e=+e,n>>>=0,i||D(t,0,n,4),y(t,e,n,r,23,4),n+4}function $(t,e,n,r,i){return e=+e,n>>>=0,i||D(t,0,n,8),y(t,e,n,r,52,8),n+8}o.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t>>>=0,e||T(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||T(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||T(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return t>>>=0,e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){t>>>=0,e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||T(t,4,this.length),g(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||T(t,4,this.length),g(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||T(t,8,this.length),g(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||T(t,8,this.length),g(this,t,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||L(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||L(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);L(this,t,e,n,i-1,-i)}var o=0,s=1,u=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===u&&0!==this[e+o-1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);L(this,t,e,n,i-1,-i)}var o=n-1,s=1,u=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===u&&0!==this[e+o+1]&&(u=1),this[e+o]=(t/s>>0)-u&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return $(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return $(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var u=o.isBuffer(t)?t:o.from(t,r),f=u.length;if(0===f)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-e;++s)this[s+e]=u[s%f]}return this};var M=/[^+/0-9A-Za-z-_]/g;function P(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function k(t){return p.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(M,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function C(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function J(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Y(t){return t!=t}var z=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()}(c={exports:{}},c.exports),c.exports),b=d.Buffer;
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */d.SlowBuffer,d.INSPECT_MAX_BYTES,d.kMaxLength;
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */
var m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function v(t,e){function n(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),e}(Error),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),e}(TypeError);function E(t){return t&&t.Math==Math&&t}function O(){return E("object"==typeof globalThis&&globalThis)||E("object"==typeof window&&window)||E("object"==typeof self&&self)||E("object"==typeof global&&global)||Function("return this")()}function B(t){return t.toString().replace("function(","function (")}var _=function(t){var e,n="object"==typeof(e=O()).navigator&&"ReactNative"===e.navigator.product?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(n);for(var r=b.alloc(t),i=0;i<t;++i)r[i]=Math.floor(256*Math.random());return r},N=function(){if("undefined"!=typeof window){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues)return function(e){return t.getRandomValues(b.alloc(e))}}if("undefined"!=typeof global&&global.crypto&&global.crypto.getRandomValues)return function(t){return global.crypto.getRandomValues(b.alloc(t))};var e;try{e=require("crypto").randomBytes}catch(t){}return e||_}();function x(t){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(t))}function A(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function U(t){return"[object BigInt64Array]"===Object.prototype.toString.call(t)}function I(t){return"[object BigUint64Array]"===Object.prototype.toString.call(t)}function j(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function T(t){return L(t)&&"[object Date]"===Object.prototype.toString.call(t)}function L(t){return"object"==typeof t&&null!==t}function D(t,e){var n=!1;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n||(console.warn(e),n=!0),t.apply(this,r)}}function R(t){if(ArrayBuffer.isView(t))return b.from(t.buffer,t.byteOffset,t.byteLength);if(x(t))return b.from(t);throw new S("Must use either Buffer or TypedArray")}var $=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,M=function(t){return"string"==typeof t&&$.test(t)},P=function(t){if(!M(t))throw new S('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var e=t.replace(/-/g,"");return b.from(e,"hex")},k=function(t,e){return void 0===e&&(e=!0),e?t.toString("hex",0,4)+"-"+t.toString("hex",4,6)+"-"+t.toString("hex",6,8)+"-"+t.toString("hex",8,10)+"-"+t.toString("hex",10,16):t.toString("hex")},C=Symbol("id"),J=function(){function t(e){if(void 0===e)this.id=t.generate();else if(e instanceof t)this[C]=b.from(e.id),this.__id=e.__id;else if(ArrayBuffer.isView(e)&&16===e.byteLength)this.id=R(e);else{if("string"!=typeof e)throw new S("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");this.id=P(e)}}return Object.defineProperty(t.prototype,"id",{get:function(){return this[C]},set:function(e){this[C]=e,t.cacheHexString&&(this.__id=k(e))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(e){if(void 0===e&&(e=!0),t.cacheHexString&&this.__id)return this.__id;var n=k(this.id,e);return t.cacheHexString&&(this.__id=n),n},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){if(!e)return!1;if(e instanceof t)return e.id.equals(this.id);try{return new t(e).id.equals(this.id)}catch(t){return!1}},t.prototype.toBinary=function(){return new Y(this.id,Y.SUBTYPE_UUID)},t.generate=function(){var t=N(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,b.from(t)},t.isValid=function(e){if(!e)return!1;if(e instanceof t)return!0;if("string"==typeof e)return M(e);if(A(e)){if(16!==e.length)return!1;try{return parseInt(e[6].toString(16)[0],10)===Y.SUBTYPE_UUID}catch(t){return!1}}return!1},t.createFromHexString=function(e){return new t(P(e))},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'+this.toHexString()+'")'},t}();Object.defineProperty(J.prototype,"_bsontype",{value:"UUID"});var Y=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);if(!(null==e||"string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||Array.isArray(e)))throw new S("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=null!=n?n:t.BSON_BINARY_SUBTYPE_DEFAULT,null==e?(this.buffer=b.alloc(t.BUFFER_SIZE),this.position=0):("string"==typeof e?this.buffer=b.from(e,"binary"):Array.isArray(e)?this.buffer=b.from(e):this.buffer=R(e),this.position=this.buffer.byteLength)}return t.prototype.put=function(e){if("string"==typeof e&&1!==e.length)throw new S("only accepts single character String");if("number"!=typeof e&&1!==e.length)throw new S("only accepts single character Uint8Array or Array");var n;if((n="string"==typeof e?e.charCodeAt(0):"number"==typeof e?e:e[0])<0||n>255)throw new S("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=n;else{var r=b.alloc(t.BUFFER_SIZE+this.buffer.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r,this.buffer[this.position++]=n}},t.prototype.write=function(t,e){if(e="number"==typeof e?e:this.position,this.buffer.length<e+t.length){var n=b.alloc(this.buffer.length+t.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n}ArrayBuffer.isView(t)?(this.buffer.set(R(t),e),this.position=e+t.byteLength>this.position?e+t.length:this.position):"string"==typeof t&&(this.buffer.write(t,e,t.length,"binary"),this.position=e+t.length>this.position?e+t.length:this.position)},t.prototype.read=function(t,e){return e=e&&e>0?e:this.position,this.buffer.slice(t,t+e)},t.prototype.value=function(t){return(t=!!t)&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},t.prototype.length=function(){return this.position},t.prototype.toJSON=function(){return this.buffer.toString("base64")},t.prototype.toString=function(t){return this.buffer.toString(t)},t.prototype.toExtendedJSON=function(t){t=t||{};var e=this.buffer.toString("base64"),n=Number(this.sub_type).toString(16);return t.legacy?{$binary:e,$type:1===n.length?"0"+n:n}:{$binary:{base64:e,subType:1===n.length?"0"+n:n}}},t.prototype.toUUID=function(){if(this.sub_type===t.SUBTYPE_UUID)return new J(this.buffer.slice(0,this.position));throw new w('Binary sub_type "'+this.sub_type+'" is not supported for converting to UUID. Only "'+t.SUBTYPE_UUID+'" is currently supported.')},t.fromExtendedJSON=function(e,n){var r,i;if(n=n||{},"$binary"in e?n.legacy&&"string"==typeof e.$binary&&"$type"in e?(i=e.$type?parseInt(e.$type,16):0,r=b.from(e.$binary,"base64")):"string"!=typeof e.$binary&&(i=e.$binary.subType?parseInt(e.$binary.subType,16):0,r=b.from(e.$binary.base64,"base64")):"$uuid"in e&&(i=4,r=P(e.$uuid)),!r)throw new S("Unexpected Binary Extended JSON format "+JSON.stringify(e));return new t(r,i)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Binary(Buffer.from("'+this.value(!0).toString("hex")+'", "hex"), '+this.sub_type+")"},t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BUFFER_SIZE=256,t.SUBTYPE_DEFAULT=0,t.SUBTYPE_FUNCTION=1,t.SUBTYPE_BYTE_ARRAY=2,t.SUBTYPE_UUID_OLD=3,t.SUBTYPE_UUID=4,t.SUBTYPE_MD5=5,t.SUBTYPE_ENCRYPTED=6,t.SUBTYPE_COLUMN=7,t.SUBTYPE_USER_DEFINED=128,t}();Object.defineProperty(Y.prototype,"_bsontype",{value:"Binary"});var z=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);this.code=e,this.scope=n}return t.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},t.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},t.fromExtendedJSON=function(e){return new t(e.$code,e.$scope)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=this.toJSON();return'new Code("'+t.code+'"'+(t.scope?", "+JSON.stringify(t.scope):"")+")"},t}();function F(t){return L(t)&&null!=t.$id&&"string"==typeof t.$ref&&(null==t.$db||"string"==typeof t.$db)}Object.defineProperty(z.prototype,"_bsontype",{value:"Code"});var V=function(){function t(e,n,r,i){if(!(this instanceof t))return new t(e,n,r,i);var o=e.split(".");2===o.length&&(r=o.shift(),e=o.shift()),this.collection=e,this.oid=n,this.db=r,this.fields=i||{}}return Object.defineProperty(t.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(t.$db=this.db),t},t.prototype.toExtendedJSON=function(t){t=t||{};var e={$ref:this.collection,$id:this.oid};return t.legacy?e:(this.db&&(e.$db=this.db),e=Object.assign(e,this.fields))},t.fromExtendedJSON=function(e){var n=Object.assign({},e);return delete n.$ref,delete n.$id,delete n.$db,new t(e.$ref,e.$id,e.$db,n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=void 0===this.oid||void 0===this.oid.toString?this.oid:this.oid.toString();return'new DBRef("'+this.namespace+'", new ObjectId("'+t+'")'+(this.db?', "'+this.db+'"':"")+")"},t}();Object.defineProperty(V.prototype,"_bsontype",{value:"DBRef"});var H=void 0;try{H=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}var q=4294967296,K=0x10000000000000000,Z=K/2,W={},X={},G=function(){function t(e,n,r){if(void 0===e&&(e=0),!(this instanceof t))return new t(e,n,r);"bigint"==typeof e?Object.assign(this,t.fromBigInt(e,!!n)):"string"==typeof e?Object.assign(this,t.fromString(e,!!n)):(this.low=0|e,this.high=0|n,this.unsigned=!!r),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return t.fromBits=function(e,n,r){return new t(e,n,r)},t.fromInt=function(e,n){var r,i,o;return n?(o=0<=(e>>>=0)&&e<256)&&(i=X[e])?i:(r=t.fromBits(e,(0|e)<0?-1:0,!0),o&&(X[e]=r),r):(o=-128<=(e|=0)&&e<128)&&(i=W[e])?i:(r=t.fromBits(e,e<0?-1:0,!1),o&&(W[e]=r),r)},t.fromNumber=function(e,n){if(isNaN(e))return n?t.UZERO:t.ZERO;if(n){if(e<0)return t.UZERO;if(e>=K)return t.MAX_UNSIGNED_VALUE}else{if(e<=-Z)return t.MIN_VALUE;if(e+1>=Z)return t.MAX_VALUE}return e<0?t.fromNumber(-e,n).neg():t.fromBits(e%q|0,e/q|0,n)},t.fromBigInt=function(e,n){return t.fromString(e.toString(),n)},t.fromString=function(e,n,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t.ZERO;if("number"==typeof n?(r=n,n=!1):n=!!n,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return t.fromString(e.substring(1),n,r).neg();for(var o=t.fromNumber(Math.pow(r,8)),s=t.ZERO,u=0;u<e.length;u+=8){var f=Math.min(8,e.length-u),a=parseInt(e.substring(u,u+f),r);if(f<8){var h=t.fromNumber(Math.pow(r,f));s=s.mul(h).add(t.fromNumber(a))}else s=(s=s.mul(o)).add(t.fromNumber(a))}return s.unsigned=n,s},t.fromBytes=function(e,n,r){return r?t.fromBytesLE(e,n):t.fromBytesBE(e,n)},t.fromBytesLE=function(e,n){return new t(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)},t.fromBytesBE=function(e,n){return new t(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)},t.isLong=function(t){return L(t)&&!0===t.__isLong__},t.fromValue=function(e,n){return"number"==typeof e?t.fromNumber(e,n):"string"==typeof e?t.fromString(e,n):t.fromBits(e.low,e.high,"boolean"==typeof n?n:e.unsigned)},t.prototype.add=function(e){t.isLong(e)||(e=t.fromValue(e));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,u=65535&e.high,f=e.low>>>16,a=0,h=0,l=0,c=0;return l+=(c+=o+(65535&e.low))>>>16,c&=65535,h+=(l+=i+f)>>>16,l&=65535,a+=(h+=r+u)>>>16,h&=65535,a+=n+s,a&=65535,t.fromBits(l<<16|c,a<<16|h,this.unsigned)},t.prototype.and=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.compare=function(e){if(t.isLong(e)||(e=t.fromValue(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},t.prototype.comp=function(t){return this.compare(t)},t.prototype.divide=function(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");if(H){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;var n=(this.unsigned?H.div_u:H.div_s)(this.low,this.high,e.low,e.high);return t.fromBits(n,H.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var r,i,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return t.UZERO;if(e.gt(this.shru(1)))return t.UONE;o=t.UZERO}else{if(this.eq(t.MIN_VALUE))return e.eq(t.ONE)||e.eq(t.NEG_ONE)?t.MIN_VALUE:e.eq(t.MIN_VALUE)?t.ONE:(r=this.shr(1).div(e).shl(1)).eq(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(i=this.sub(e.mul(r)),o=r.add(i.div(e)));if(e.eq(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=t.ZERO}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),u=s<=48?1:Math.pow(2,s-48),f=t.fromNumber(r),a=f.mul(e);a.isNegative()||a.gt(i);)r-=u,a=(f=t.fromNumber(r,this.unsigned)).mul(e);f.isZero()&&(f=t.ONE),o=o.add(f),i=i.sub(a)}return o},t.prototype.div=function(t){return this.divide(t)},t.prototype.equals=function(e){return t.isLong(e)||(e=t.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},t.prototype.eq=function(t){return this.equals(t)},t.prototype.getHighBits=function(){return this.high},t.prototype.getHighBitsUnsigned=function(){return this.high>>>0},t.prototype.getLowBits=function(){return this.low},t.prototype.getLowBitsUnsigned=function(){return this.low>>>0},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(t.MIN_VALUE)?64:this.neg().getNumBitsAbs();var e,n=0!==this.high?this.high:this.low;for(e=31;e>0&&0==(n&1<<e);e--);return 0!==this.high?e+33:e+1},t.prototype.greaterThan=function(t){return this.comp(t)>0},t.prototype.gt=function(t){return this.greaterThan(t)},t.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},t.prototype.gte=function(t){return this.greaterThanOrEqual(t)},t.prototype.ge=function(t){return this.greaterThanOrEqual(t)},t.prototype.isEven=function(){return 0==(1&this.low)},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isOdd=function(){return 1==(1&this.low)},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isZero=function(){return 0===this.high&&0===this.low},t.prototype.lessThan=function(t){return this.comp(t)<0},t.prototype.lt=function(t){return this.lessThan(t)},t.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},t.prototype.lte=function(t){return this.lessThanOrEqual(t)},t.prototype.modulo=function(e){if(t.isLong(e)||(e=t.fromValue(e)),H){var n=(this.unsigned?H.rem_u:H.rem_s)(this.low,this.high,e.low,e.high);return t.fromBits(n,H.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},t.prototype.mod=function(t){return this.modulo(t)},t.prototype.rem=function(t){return this.modulo(t)},t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(t.isLong(e)||(e=t.fromValue(e)),H){var n=H.mul(this.low,this.high,e.low,e.high);return t.fromBits(n,H.get_high(),this.unsigned)}if(e.isZero())return t.ZERO;if(this.eq(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.eq(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(t.TWO_PWR_24)&&e.lt(t.TWO_PWR_24))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,u=e.high>>>16,f=65535&e.high,a=e.low>>>16,h=65535&e.low,l=0,c=0,p=0,g=0;return p+=(g+=s*h)>>>16,g&=65535,c+=(p+=o*h)>>>16,p&=65535,c+=(p+=s*a)>>>16,p&=65535,l+=(c+=i*h)>>>16,c&=65535,l+=(c+=o*a)>>>16,c&=65535,l+=(c+=s*f)>>>16,c&=65535,l+=r*h+i*a+o*f+s*u,l&=65535,t.fromBits(p<<16|g,l<<16|c,this.unsigned)},t.prototype.mul=function(t){return this.multiply(t)},t.prototype.negate=function(){return!this.unsigned&&this.eq(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.neg=function(){return this.negate()},t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.notEquals=function(t){return!this.equals(t)},t.prototype.neq=function(t){return this.notEquals(t)},t.prototype.ne=function(t){return this.notEquals(t)},t.prototype.or=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.shiftLeft=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shl=function(t){return this.shiftLeft(t)},t.prototype.shiftRight=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shr=function(t){return this.shiftRight(t)},t.prototype.shiftRightUnsigned=function(e){if(t.isLong(e)&&(e=e.toInt()),0===(e&=63))return this;var n=this.high;if(e<32){var r=this.low;return t.fromBits(r>>>e|n<<32-e,n>>>e,this.unsigned)}return 32===e?t.fromBits(n,0,this.unsigned):t.fromBits(n>>>e-32,0,this.unsigned)},t.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},t.prototype.shru=function(t){return this.shiftRightUnsigned(t)},t.prototype.subtract=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.neg())},t.prototype.sub=function(t){return this.subtract(t)},t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*q+(this.low>>>0):this.high*q+(this.low>>>0)},t.prototype.toBigInt=function(){return BigInt(this.toString())},t.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},t.prototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},t.prototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},t.prototype.toSigned=function(){return this.unsigned?t.fromBits(this.low,this.high,!1):this},t.prototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(t.MIN_VALUE)){var n=t.fromNumber(e),r=this.div(n),i=r.mul(n).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=t.fromNumber(Math.pow(e,6),this.unsigned),s=this,u="";;){var f=s.div(o),a=(s.sub(f.mul(o)).toInt()>>>0).toString(e);if((s=f).isZero())return a+u;for(;a.length<6;)a="0"+a;u=""+a+u}},t.prototype.toUnsigned=function(){return this.unsigned?this:t.fromBits(this.low,this.high,!0)},t.prototype.xor=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.eqz=function(){return this.isZero()},t.prototype.le=function(t){return this.lessThanOrEqual(t)},t.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},t.fromExtendedJSON=function(e,n){var r=t.fromString(e.$numberLong);return n&&n.relaxed?r.toNumber():r},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Long("'+this.toString()+'"'+(this.unsigned?", true":"")+")"},t.TWO_PWR_24=t.fromInt(16777216),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t}();Object.defineProperty(G.prototype,"__isLong__",{value:!0}),Object.defineProperty(G.prototype,"_bsontype",{value:"Long"});var Q=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,tt=/^(\+|-)?(Infinity|inf)$/i,et=/^(\+|-)?NaN$/i,nt=6111,rt=-6176,it=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),ot=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),st=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),ut=/^([-+])?(\d+)?$/;function ft(t){return!isNaN(parseInt(t,10))}function at(t){var e=G.fromNumber(1e9),n=G.fromNumber(0);if(!(t.parts[0]||t.parts[1]||t.parts[2]||t.parts[3]))return{quotient:t,rem:n};for(var r=0;r<=3;r++)n=(n=n.shiftLeft(32)).add(new G(t.parts[r],0)),t.parts[r]=n.div(e).low,n=n.modulo(e);return{quotient:t,rem:n}}function ht(t,e){throw new S('"'+t+'" is not a valid Decimal128 string - '+e)}var lt=function(){function t(e){if(!(this instanceof t))return new t(e);this.bytes="string"==typeof e?t.fromString(e).bytes:e}return t.fromString=function(e){var n,r=!1,i=!1,o=!1,s=0,u=0,f=0,a=0,h=0,l=[0],c=0,p=0,g=0,y=0,d=0,m=0,v=new G(0,0),w=new G(0,0),E=0;if(e.length>=7e3)throw new S(e+" not a valid Decimal128 string");var O=e.match(Q),B=e.match(tt),_=e.match(et);if(!O&&!B&&!_||0===e.length)throw new S(e+" not a valid Decimal128 string");if(O){var N=O[2],x=O[4],A=O[5],U=O[6];x&&void 0===U&&ht(e,"missing exponent power"),x&&void 0===N&&ht(e,"missing exponent base"),void 0===x&&(A||U)&&ht(e,"missing e before exponent")}if("+"!==e[E]&&"-"!==e[E]||(r="-"===e[E++]),!ft(e[E])&&"."!==e[E]){if("i"===e[E]||"I"===e[E])return new t(b.from(r?ot:st));if("N"===e[E])return new t(b.from(it))}for(;ft(e[E])||"."===e[E];)"."!==e[E]?(c<34&&("0"!==e[E]||o)&&(o||(h=u),o=!0,l[p++]=parseInt(e[E],10),c+=1),o&&(f+=1),i&&(a+=1),u+=1,E+=1):(i&&ht(e,"contains multiple periods"),i=!0,E+=1);if(i&&!u)throw new S(e+" not a valid Decimal128 string");if("e"===e[E]||"E"===e[E]){var I=e.substr(++E).match(ut);if(!I||!I[2])return new t(b.from(it));d=parseInt(I[0],10),E+=I[0].length}if(e[E])return new t(b.from(it));if(g=0,c){if(y=c-1,1!==(s=f))for(;0===l[h+s-1];)s-=1}else g=0,y=0,l[0]=0,f=1,c=1,s=0;for(d<=a&&a-d>16384?d=rt:d-=a;d>nt;){if((y+=1)-g>34){if(l.join("").match(/^0+$/)){d=nt;break}ht(e,"overflow")}d-=1}for(;d<rt||c<f;){if(0===y&&s<c){d=rt,s=0;break}if(c<f?f-=1:y-=1,d<nt)d+=1;else{if(l.join("").match(/^0+$/)){d=nt;break}ht(e,"overflow")}}if(y-g+1<s){var j=u;i&&(h+=1,j+=1),r&&(h+=1,j+=1);var T=parseInt(e[h+y+1],10),L=0;if(T>=5&&(L=1,5===T))for(L=l[y]%2==1?1:0,m=h+y+2;m<j;m++)if(parseInt(e[m],10)){L=1;break}if(L)for(var D=y;D>=0;D--)if(++l[D]>9&&(l[D]=0,0===D)){if(!(d<nt))return new t(b.from(r?ot:st));d+=1,l[D]=1}}if(v=G.fromNumber(0),w=G.fromNumber(0),0===s)v=G.fromNumber(0),w=G.fromNumber(0);else if(y-g<17){D=g;for(w=G.fromNumber(l[D++]),v=new G(0,0);D<=y;D++)w=(w=w.multiply(G.fromNumber(10))).add(G.fromNumber(l[D]))}else{D=g;for(v=G.fromNumber(l[D++]);D<=y-17;D++)v=(v=v.multiply(G.fromNumber(10))).add(G.fromNumber(l[D]));for(w=G.fromNumber(l[D++]);D<=y;D++)w=(w=w.multiply(G.fromNumber(10))).add(G.fromNumber(l[D]))}var R,$,M,P,k=function(t,e){if(!t&&!e)return{high:G.fromNumber(0),low:G.fromNumber(0)};var n=t.shiftRightUnsigned(32),r=new G(t.getLowBits(),0),i=e.shiftRightUnsigned(32),o=new G(e.getLowBits(),0),s=n.multiply(i),u=n.multiply(o),f=r.multiply(i),a=r.multiply(o);return s=s.add(u.shiftRightUnsigned(32)),u=new G(u.getLowBits(),0).add(f).add(a.shiftRightUnsigned(32)),{high:s=s.add(u.shiftRightUnsigned(32)),low:a=u.shiftLeft(32).add(new G(a.getLowBits(),0))}}(v,G.fromString("100000000000000000"));k.low=k.low.add(w),R=k.low,$=w,M=R.high>>>0,P=$.high>>>0,(M<P||M===P&&R.low>>>0<$.low>>>0)&&(k.high=k.high.add(G.fromNumber(1))),n=d+6176;var C={low:G.fromNumber(0),high:G.fromNumber(0)};k.high.shiftRightUnsigned(49).and(G.fromNumber(1)).equals(G.fromNumber(1))?(C.high=C.high.or(G.fromNumber(3).shiftLeft(61)),C.high=C.high.or(G.fromNumber(n).and(G.fromNumber(16383).shiftLeft(47))),C.high=C.high.or(k.high.and(G.fromNumber(0x7fffffffffff)))):(C.high=C.high.or(G.fromNumber(16383&n).shiftLeft(49)),C.high=C.high.or(k.high.and(G.fromNumber(562949953421311)))),C.low=k.low,r&&(C.high=C.high.or(G.fromString("9223372036854775808")));var J=b.alloc(16);return E=0,J[E++]=255&C.low.low,J[E++]=C.low.low>>8&255,J[E++]=C.low.low>>16&255,J[E++]=C.low.low>>24&255,J[E++]=255&C.low.high,J[E++]=C.low.high>>8&255,J[E++]=C.low.high>>16&255,J[E++]=C.low.high>>24&255,J[E++]=255&C.high.low,J[E++]=C.high.low>>8&255,J[E++]=C.high.low>>16&255,J[E++]=C.high.low>>24&255,J[E++]=255&C.high.high,J[E++]=C.high.high>>8&255,J[E++]=C.high.high>>16&255,J[E++]=C.high.high>>24&255,new t(J)},t.prototype.toString=function(){for(var t,e=0,n=new Array(36),r=0;r<n.length;r++)n[r]=0;var i,o,s,u=0,f=!1,a={parts:[0,0,0,0]},h=[];u=0;var l=this.bytes,c=l[u++]|l[u++]<<8|l[u++]<<16|l[u++]<<24,p=l[u++]|l[u++]<<8|l[u++]<<16|l[u++]<<24,g=l[u++]|l[u++]<<8|l[u++]<<16|l[u++]<<24,y=l[u++]|l[u++]<<8|l[u++]<<16|l[u++]<<24;u=0,{low:new G(c,p),high:new G(g,y)}.high.lessThan(G.ZERO)&&h.push("-");var d=y>>26&31;if(d>>3==3){if(30===d)return h.join("")+"Infinity";if(31===d)return"NaN";t=y>>15&16383,i=8+(y>>14&1)}else i=y>>14&7,t=y>>17&16383;var b=t-6176;if(a.parts[0]=(16383&y)+((15&i)<<14),a.parts[1]=g,a.parts[2]=p,a.parts[3]=c,0===a.parts[0]&&0===a.parts[1]&&0===a.parts[2]&&0===a.parts[3])f=!0;else for(s=3;s>=0;s--){var m=0,v=at(a);if(a=v.quotient,m=v.rem.low)for(o=8;o>=0;o--)n[9*s+o]=m%10,m=Math.floor(m/10)}if(f)e=1,n[u]=0;else for(e=36;!n[u];)e-=1,u+=1;var w=e-1+b;if(w>=34||w<=-7||b>0){if(e>34)return h.push("0"),b>0?h.push("E+"+b):b<0&&h.push("E"+b),h.join("");h.push(""+n[u++]),(e-=1)&&h.push(".");for(r=0;r<e;r++)h.push(""+n[u++]);h.push("E"),w>0?h.push("+"+w):h.push(""+w)}else if(b>=0)for(r=0;r<e;r++)h.push(""+n[u++]);else{var S=e+b;if(S>0)for(r=0;r<S;r++)h.push(""+n[u++]);else h.push("0");for(h.push(".");S++<0;)h.push("0");for(r=0;r<e-Math.max(S-1,0);r++)h.push(""+n[u++])}return h.join("")},t.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},t.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},t.fromExtendedJSON=function(e){return t.fromString(e.$numberDecimal)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Decimal128("'+this.toString()+'")'},t}();Object.defineProperty(lt.prototype,"_bsontype",{value:"Decimal128"});var ct=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.prototype.toString=function(t){return this.value.toString(t)},t.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-"+this.value.toFixed(1)}:(Number.isInteger(this.value)?(e=this.value.toFixed(1)).length>=13&&(e=this.value.toExponential(13).toUpperCase()):e=this.value.toString(),{$numberDouble:e});var e},t.fromExtendedJSON=function(e,n){var r=parseFloat(e.$numberDouble);return n&&n.relaxed?r:new t(r)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Double("+this.toExtendedJSON().$numberDouble+")"},t}();Object.defineProperty(ct.prototype,"_bsontype",{value:"Double"});var pt=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(t){return this.value.toString(t)},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},t.fromExtendedJSON=function(e,n){return n&&n.relaxed?parseInt(e.$numberInt,10):new t(e.$numberInt)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Int32("+this.valueOf()+")"},t}();Object.defineProperty(pt.prototype,"_bsontype",{value:"Int32"});var gt=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$maxKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MaxKey()"},t}();Object.defineProperty(gt.prototype,"_bsontype",{value:"MaxKey"});var yt=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$minKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MinKey()"},t}();Object.defineProperty(yt.prototype,"_bsontype",{value:"MinKey"});var dt=new RegExp("^[0-9a-fA-F]{24}$"),bt=null,mt=Symbol("id"),vt=function(){function t(e){if(!(this instanceof t))return new t(e);if(e instanceof t&&(this[mt]=e.id,this.__id=e.__id),"object"==typeof e&&e&&"id"in e&&("toHexString"in e&&"function"==typeof e.toHexString?this[mt]=b.from(e.toHexString(),"hex"):this[mt]="string"==typeof e.id?b.from(e.id):e.id),null!=e&&"number"!=typeof e||(this[mt]=t.generate("number"==typeof e?e:void 0),t.cacheHexString&&(this.__id=this.id.toString("hex"))),ArrayBuffer.isView(e)&&12===e.byteLength&&(this[mt]=R(e)),"string"==typeof e)if(12===e.length){var n=b.from(e);12===n.byteLength&&(this[mt]=n)}else{if(24!==e.length||!dt.test(e))throw new S("Argument passed in must be a Buffer or string of 12 bytes or a string of 24 hex characters");this[mt]=b.from(e,"hex")}t.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(t.prototype,"id",{get:function(){return this[mt]},set:function(e){this[mt]=e,t.cacheHexString&&(this.__id=e.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(){if(t.cacheHexString&&this.__id)return this.__id;var e=this.id.toString("hex");return t.cacheHexString&&!this.__id&&(this.__id=e),e},t.getInc=function(){return t.index=(t.index+1)%16777215},t.generate=function(e){"number"!=typeof e&&(e=~~(Date.now()/1e3));var n=t.getInc(),r=b.alloc(12);return r.writeUInt32BE(e,0),null===bt&&(bt=N(5)),r[4]=bt[0],r[5]=bt[1],r[6]=bt[2],r[7]=bt[3],r[8]=bt[4],r[11]=255&n,r[10]=n>>8&255,r[9]=n>>16&255,r},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){return null!=e&&(e instanceof t?this.toString()===e.toString():"string"==typeof e&&t.isValid(e)&&12===e.length&&A(this.id)?e===b.prototype.toString.call(this.id,"latin1"):"string"==typeof e&&t.isValid(e)&&24===e.length?e.toLowerCase()===this.toHexString():"string"==typeof e&&t.isValid(e)&&12===e.length?b.from(e).equals(this.id):"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&e.toHexString()===this.toHexString())},t.prototype.getTimestamp=function(){var t=new Date,e=this.id.readUInt32BE(0);return t.setTime(1e3*Math.floor(e)),t},t.createPk=function(){return new t},t.createFromTime=function(e){var n=b.from([0,0,0,0,0,0,0,0,0,0,0,0]);return n.writeUInt32BE(e,0),new t(n)},t.createFromHexString=function(e){if(void 0===e||null!=e&&24!==e.length)throw new S("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new t(b.from(e,"hex"))},t.isValid=function(e){return null!=e&&("number"==typeof e||("string"==typeof e?12===e.length||24===e.length&&dt.test(e):e instanceof t||(!(!A(e)||12!==e.length)||"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&("string"==typeof e.id?12===e.id.length:24===e.toHexString().length&&dt.test(e.id.toString("hex"))))))},t.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},t.fromExtendedJSON=function(e){return new t(e.$oid)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new ObjectId("'+this.toHexString()+'")'},t.index=~~(16777215*Math.random()),t}();Object.defineProperty(vt.prototype,"generate",{value:D((function(t){return vt.generate(t)}),"Please use the static `ObjectId.generate(time)` instead")}),Object.defineProperty(vt.prototype,"getInc",{value:D((function(){return vt.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(vt.prototype,"get_inc",{value:D((function(){return vt.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(vt,"get_inc",{value:D((function(){return vt.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(vt.prototype,"_bsontype",{value:"ObjectID"});var wt=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);if(this.pattern=e,this.options=(null!=n?n:"").split("").sort().join(""),-1!==this.pattern.indexOf("\0"))throw new w("BSON Regex patterns cannot contain null bytes, found: "+JSON.stringify(this.pattern));if(-1!==this.options.indexOf("\0"))throw new w("BSON Regex options cannot contain null bytes, found: "+JSON.stringify(this.options));for(var r=0;r<this.options.length;r++)if("i"!==this.options[r]&&"m"!==this.options[r]&&"x"!==this.options[r]&&"l"!==this.options[r]&&"s"!==this.options[r]&&"u"!==this.options[r])throw new w("The regular expression option ["+this.options[r]+"] is not supported")}return t.parseOptions=function(t){return t?t.split("").sort().join(""):""},t.prototype.toExtendedJSON=function(t){return(t=t||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},t.fromExtendedJSON=function(e){if("$regex"in e){if("string"==typeof e.$regex)return new t(e.$regex,t.parseOptions(e.$options));if("BSONRegExp"===e.$regex._bsontype)return e}if("$regularExpression"in e)return new t(e.$regularExpression.pattern,t.parseOptions(e.$regularExpression.options));throw new S("Unexpected BSONRegExp EJSON object form: "+JSON.stringify(e))},t}();Object.defineProperty(wt.prototype,"_bsontype",{value:"BSONRegExp"});var St=function(){function t(e){if(!(this instanceof t))return new t(e);this.value=e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return this.value},t.prototype.inspect=function(){return'new BSONSymbol("'+this.value+'")'},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(){return{$symbol:this.value}},t.fromExtendedJSON=function(e){return new t(e.$symbol)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t}();Object.defineProperty(St.prototype,"_bsontype",{value:"Symbol"});var Et=G,Ot=function(t){function e(n,r){var i=this;return i instanceof e?(i=G.isLong(n)?t.call(this,n.low,n.high,!0)||this:L(n)&&void 0!==n.t&&void 0!==n.i?t.call(this,n.i,n.t,!0)||this:t.call(this,n,r,!0)||this,Object.defineProperty(i,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),i):new e(n,r)}return v(e,t),e.prototype.toJSON=function(){return{$timestamp:this.toString()}},e.fromInt=function(t){return new e(G.fromInt(t,!0))},e.fromNumber=function(t){return new e(G.fromNumber(t,!0))},e.fromBits=function(t,n){return new e(t,n)},e.fromString=function(t,n){return new e(G.fromString(t,!0,n))},e.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},e.fromExtendedJSON=function(t){return new e(t.$timestamp)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Timestamp({ t: "+this.getHighBits()+", i: "+this.getLowBits()+" })"},e.MAX_VALUE=G.MAX_UNSIGNED_VALUE,e}(Et);function Bt(t){return L(t)&&Reflect.has(t,"_bsontype")&&"string"==typeof t._bsontype}var _t=2147483647,Nt=-2147483648,xt=0x8000000000000000,At=-0x8000000000000000,Ut={$oid:vt,$binary:Y,$uuid:Y,$symbol:St,$numberInt:pt,$numberDecimal:lt,$numberDouble:ct,$numberLong:G,$minKey:yt,$maxKey:gt,$regex:wt,$regularExpression:wt,$timestamp:Ot};function It(t,e){if(void 0===e&&(e={}),"number"==typeof t){if(e.relaxed||e.legacy)return t;if(Math.floor(t)===t){if(t>=Nt&&t<=_t)return new pt(t);if(t>=At&&t<=xt)return G.fromNumber(t)}return new ct(t)}if(null==t||"object"!=typeof t)return t;if(t.$undefined)return null;for(var n=Object.keys(t).filter((function(e){return e.startsWith("$")&&null!=t[e]})),r=0;r<n.length;r++){var i=Ut[n[r]];if(i)return i.fromExtendedJSON(t,e)}if(null!=t.$date){var o=t.$date,s=new Date;return e.legacy?"number"==typeof o?s.setTime(o):"string"==typeof o&&s.setTime(Date.parse(o)):"string"==typeof o?s.setTime(Date.parse(o)):G.isLong(o)?s.setTime(o.toNumber()):"number"==typeof o&&e.relaxed&&s.setTime(o),s}if(null!=t.$code){var u=Object.assign({},t);return t.$scope&&(u.$scope=It(t.$scope)),z.fromExtendedJSON(t)}if(F(t)||t.$dbPointer){var f=t.$ref?t:t.$dbPointer;if(f instanceof V)return f;var a=Object.keys(f).filter((function(t){return t.startsWith("$")})),h=!0;if(a.forEach((function(t){-1===["$ref","$id","$db"].indexOf(t)&&(h=!1)})),h)return V.fromExtendedJSON(f)}return t}function jt(t){var e=t.toISOString();return 0!==t.getUTCMilliseconds()?e:e.slice(0,-5)+"Z"}function Tt(t,e){if(("object"==typeof t||"function"==typeof t)&&null!==t){var n=e.seenObjects.findIndex((function(e){return e.obj===t}));if(-1!==n){var r=e.seenObjects.map((function(t){return t.propertyName})),i=r.slice(0,n).map((function(t){return t+" -> "})).join(""),o=r[n],s=" -> "+r.slice(n+1,r.length-1).map((function(t){return t+" -> "})).join(""),u=r[r.length-1],f=" ".repeat(i.length+o.length/2),a="-".repeat(s.length+(o.length+u.length)/2-1);throw new S("Converting circular structure to EJSON:\n    "+i+o+s+u+"\n    "+f+"\\"+a+"/")}e.seenObjects[e.seenObjects.length-1].obj=t}if(Array.isArray(t))return function(t,e){return t.map((function(t,n){e.seenObjects.push({propertyName:"index "+n,obj:null});try{return Tt(t,e)}finally{e.seenObjects.pop()}}))}(t,e);if(void 0===t)return null;if(t instanceof Date||T(t)){var h=t.getTime(),l=h>-1&&h<2534023188e5;return e.legacy?e.relaxed&&l?{$date:t.getTime()}:{$date:jt(t)}:e.relaxed&&l?{$date:jt(t)}:{$date:{$numberLong:t.getTime().toString()}}}if(!("number"!=typeof t||e.relaxed&&isFinite(t))){if(Math.floor(t)===t){var c=t>=At&&t<=xt;if(t>=Nt&&t<=_t)return{$numberInt:t.toString()};if(c)return{$numberLong:t.toString()}}return{$numberDouble:t.toString()}}if(t instanceof RegExp||j(t)){var p=t.flags;if(void 0===p){var g=t.toString().match(/[gimuy]*$/);g&&(p=g[0])}return new wt(t.source,p).toExtendedJSON(e)}return null!=t&&"object"==typeof t?function(t,e){if(null==t||"object"!=typeof t)throw new w("not an object instance");var n=t._bsontype;if(void 0===n){var r={};for(var i in t){e.seenObjects.push({propertyName:i,obj:null});try{r[i]=Tt(t[i],e)}finally{e.seenObjects.pop()}}return r}if(Bt(t)){var o=t;if("function"!=typeof o.toExtendedJSON){var s=Lt[t._bsontype];if(!s)throw new S("Unrecognized or invalid _bsontype: "+t._bsontype);o=s(o)}return"Code"===n&&o.scope?o=new z(o.code,Tt(o.scope,e)):"DBRef"===n&&o.oid&&(o=new V(Tt(o.collection,e),Tt(o.oid,e),Tt(o.db,e),Tt(o.fields,e))),o.toExtendedJSON(e)}throw new w("_bsontype must be a string, but was: "+typeof n)}(t,e):t}var Lt={Binary:function(t){return new Y(t.value(),t.sub_type)},Code:function(t){return new z(t.code,t.scope)},DBRef:function(t){return new V(t.collection||t.namespace,t.oid,t.db,t.fields)},Decimal128:function(t){return new lt(t.bytes)},Double:function(t){return new ct(t.value)},Int32:function(t){return new pt(t.value)},Long:function(t){return G.fromBits(null!=t.low?t.low:t.low_,null!=t.low?t.high:t.high_,null!=t.low?t.unsigned:t.unsigned_)},MaxKey:function(){return new gt},MinKey:function(){return new yt},ObjectID:function(t){return new vt(t)},ObjectId:function(t){return new vt(t)},BSONRegExp:function(t){return new wt(t.pattern,t.options)},Symbol:function(t){return new St(t.value)},Timestamp:function(t){return Ot.fromBits(t.low,t.high)}};t.EJSON=void 0,function(t){function e(t,e){var n=Object.assign({},{relaxed:!0,legacy:!1},e);return"boolean"==typeof n.relaxed&&(n.strict=!n.relaxed),"boolean"==typeof n.strict&&(n.relaxed=!n.strict),JSON.parse(t,(function(t,e){if(-1!==t.indexOf("\0"))throw new w("BSON Document field names cannot contain null bytes, found: "+JSON.stringify(t));return It(e,n)}))}function n(t,e,n,r){null!=n&&"object"==typeof n&&(r=n,n=0),null==e||"object"!=typeof e||Array.isArray(e)||(r=e,e=void 0,n=0);var i=Tt(t,Object.assign({relaxed:!0,legacy:!1},r,{seenObjects:[{propertyName:"(root)",obj:null}]}));return JSON.stringify(i,e,n)}t.parse=e,t.stringify=n,t.serialize=function(t,e){return e=e||{},JSON.parse(n(t,e))},t.deserialize=function(t,n){return n=n||{},e(JSON.stringify(t),n)}}(t.EJSON||(t.EJSON={})),t.Map=void 0;var Dt=O();Dt.Map?t.Map=Dt.Map:t.Map=function(){function t(t){void 0===t&&(t=[]),this._keys=[],this._values={};for(var e=0;e<t.length;e++)if(null!=t[e]){var n=t[e],r=n[0],i=n[1];this._keys.push(r),this._values[r]={v:i,i:this._keys.length-1}}}return t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(t){var e=this._values[t];return null!=e&&(delete this._values[t],this._keys.splice(e.i,1),!0)},t.prototype.entries=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?[n,t._values[n].v]:void 0,done:void 0===n}}}},t.prototype.forEach=function(t,e){e=e||this;for(var n=0;n<this._keys.length;n++){var r=this._keys[n];t.call(e,this._values[r].v,r,e)}},t.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},t.prototype.has=function(t){return null!=this._values[t]},t.prototype.keys=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?n:void 0,done:void 0===n}}}},t.prototype.set=function(t,e){return this._values[t]?(this._values[t].v=e,this):(this._keys.push(t),this._values[t]={v:e,i:this._keys.length-1},this)},t.prototype.values=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?t._values[n].v:void 0,done:void 0===n}}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),t}();var Rt=2147483647,$t=-2147483648,Mt=Math.pow(2,63)-1,Pt=-Math.pow(2,63),kt=Math.pow(2,53),Ct=-Math.pow(2,53);function Jt(t,e,n){var r=5;if(Array.isArray(t))for(var i=0;i<t.length;i++)r+=Yt(i.toString(),t[i],e,!0,n);else for(var o in t.toBSON&&(t=t.toBSON()),t)r+=Yt(o,t[o],e,!1,n);return r}function Yt(t,e,n,r,i){switch(void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),e&&e.toBSON&&(e=e.toBSON()),typeof e){case"string":return 1+b.byteLength(t,"utf8")+1+4+b.byteLength(e,"utf8")+1;case"number":return Math.floor(e)===e&&e>=Ct&&e<=kt&&e>=$t&&e<=Rt?(null!=t?b.byteLength(t,"utf8")+1:0)+5:(null!=t?b.byteLength(t,"utf8")+1:0)+9;case"undefined":return r||!i?(null!=t?b.byteLength(t,"utf8")+1:0)+1:0;case"boolean":return(null!=t?b.byteLength(t,"utf8")+1:0)+2;case"object":if(null==e||"MinKey"===e._bsontype||"MaxKey"===e._bsontype)return(null!=t?b.byteLength(t,"utf8")+1:0)+1;if("ObjectId"===e._bsontype||"ObjectID"===e._bsontype)return(null!=t?b.byteLength(t,"utf8")+1:0)+13;if(e instanceof Date||T(e))return(null!=t?b.byteLength(t,"utf8")+1:0)+9;if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer||x(e))return(null!=t?b.byteLength(t,"utf8")+1:0)+6+e.byteLength;if("Long"===e._bsontype||"Double"===e._bsontype||"Timestamp"===e._bsontype)return(null!=t?b.byteLength(t,"utf8")+1:0)+9;if("Decimal128"===e._bsontype)return(null!=t?b.byteLength(t,"utf8")+1:0)+17;if("Code"===e._bsontype)return null!=e.scope&&Object.keys(e.scope).length>0?(null!=t?b.byteLength(t,"utf8")+1:0)+1+4+4+b.byteLength(e.code.toString(),"utf8")+1+Jt(e.scope,n,i):(null!=t?b.byteLength(t,"utf8")+1:0)+1+4+b.byteLength(e.code.toString(),"utf8")+1;if("Binary"===e._bsontype)return e.sub_type===Y.SUBTYPE_BYTE_ARRAY?(null!=t?b.byteLength(t,"utf8")+1:0)+(e.position+1+4+1+4):(null!=t?b.byteLength(t,"utf8")+1:0)+(e.position+1+4+1);if("Symbol"===e._bsontype)return(null!=t?b.byteLength(t,"utf8")+1:0)+b.byteLength(e.value,"utf8")+4+1+1;if("DBRef"===e._bsontype){var o=Object.assign({$ref:e.collection,$id:e.oid},e.fields);return null!=e.db&&(o.$db=e.db),(null!=t?b.byteLength(t,"utf8")+1:0)+1+Jt(o,n,i)}return e instanceof RegExp||j(e)?(null!=t?b.byteLength(t,"utf8")+1:0)+1+b.byteLength(e.source,"utf8")+1+(e.global?1:0)+(e.ignoreCase?1:0)+(e.multiline?1:0)+1:"BSONRegExp"===e._bsontype?(null!=t?b.byteLength(t,"utf8")+1:0)+1+b.byteLength(e.pattern,"utf8")+1+b.byteLength(e.options,"utf8")+1:(null!=t?b.byteLength(t,"utf8")+1:0)+Jt(e,n,i)+1;case"function":if(e instanceof RegExp||j(e)||"[object RegExp]"===String.call(e))return(null!=t?b.byteLength(t,"utf8")+1:0)+1+b.byteLength(e.source,"utf8")+1+(e.global?1:0)+(e.ignoreCase?1:0)+(e.multiline?1:0)+1;if(n&&null!=e.scope&&Object.keys(e.scope).length>0)return(null!=t?b.byteLength(t,"utf8")+1:0)+1+4+4+b.byteLength(B(e),"utf8")+1+Jt(e.scope,n,i);if(n)return(null!=t?b.byteLength(t,"utf8")+1:0)+1+4+b.byteLength(B(e),"utf8")+1}return 0}function zt(t,e,n){for(var r=0,i=e;i<n;i+=1){var o=t[i];if(r){if(128!=(192&o))return!1;r-=1}else if(128&o)if(192==(224&o))r=1;else if(224==(240&o))r=2;else{if(240!=(248&o))return!1;r=3}}return!r}var Ft=G.fromNumber(kt),Vt=G.fromNumber(Ct),Ht={};function qt(t,e,n){var r=(e=null==e?{}:e)&&e.index?e.index:0,i=t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24;if(i<5)throw new w("bson size must be >= 5, is "+i);if(e.allowObjectSmallerThanBufferSize&&t.length<i)throw new w("buffer length "+t.length+" must be >= bson size "+i);if(!e.allowObjectSmallerThanBufferSize&&t.length!==i)throw new w("buffer length "+t.length+" must === bson size "+i);if(i+r>t.byteLength)throw new w("(bson size "+i+" + options.index "+r+" must be <= buffer length "+t.byteLength+")");if(0!==t[r+i-1])throw new w("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return Zt(t,r,e,n)}var Kt=/^\$ref$|^\$id$|^\$db$/;function Zt(t,e,n,r){void 0===r&&(r=!1);var i=null!=n.evalFunctions&&n.evalFunctions,o=null!=n.cacheFunctions&&n.cacheFunctions,s=null==n.fieldsAsRaw?null:n.fieldsAsRaw,u=null!=n.raw&&n.raw,f="boolean"==typeof n.bsonRegExp&&n.bsonRegExp,a=null!=n.promoteBuffers&&n.promoteBuffers,h=null==n.promoteLongs||n.promoteLongs,l=null==n.promoteValues||n.promoteValues,c=e;if(t.length<5)throw new w("corrupt bson message < 5 bytes long");var p=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;if(p<5||p>t.length)throw new w("corrupt bson message");for(var g=r?[]:{},y=0,d=!r&&null;;){var m=t[e++];if(0===m)break;for(var v=e;0!==t[v]&&v<t.length;)v++;if(v>=t.byteLength)throw new w("Bad BSON Document: illegal CString");var S=r?y++:t.toString("utf8",e,v);!1!==d&&"$"===S[0]&&(d=Kt.test(S));var E=void 0;if(e=v+1,2===m){if((Z=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Z>t.length-e||0!==t[e+Z-1])throw new w("bad string length in bson");E=Xt(t,e,e+Z-1),e+=Z}else if(7===m){var O=b.alloc(12);t.copy(O,0,e,e+12),E=new vt(O),e+=12}else if(16===m&&!1===l)E=new pt(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24);else if(16===m)E=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;else if(1===m&&!1===l)E=new ct(t.readDoubleLE(e)),e+=8;else if(1===m)E=t.readDoubleLE(e),e+=8;else if(9===m){var B=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,_=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;E=new Date(new G(B,_).toNumber())}else if(8===m){if(0!==t[e]&&1!==t[e])throw new w("illegal boolean type value");E=1===t[e++]}else if(3===m){var N=e;if((q=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)<=0||q>t.length-e)throw new w("bad embedded document length in bson");E=u?t.slice(e,e+q):Zt(t,N,n,!1),e+=q}else if(4===m){N=e;var x=n,A=e+(q=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24);if(s&&s[S]){for(var U in x={},n)x[U]=n[U];x.raw=!0}if(E=Zt(t,N,x,!0),0!==t[(e+=q)-1])throw new w("invalid array terminator byte");if(e!==A)throw new w("corrupted array bson")}else if(6===m)E=void 0;else if(10===m)E=null;else if(18===m){B=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,_=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;var I=new G(B,_);E=h&&!0===l&&I.lessThanOrEqual(Ft)&&I.greaterThanOrEqual(Vt)?I.toNumber():I}else if(19===m){var j=b.alloc(16);t.copy(j,0,e,e+16),e+=16;var T=new lt(j);E="toObject"in T&&"function"==typeof T.toObject?T.toObject():T}else if(5===m){var L=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,D=L,R=t[e++];if(L<0)throw new w("Negative binary type element size found");if(L>t.byteLength)throw new w("Binary type size larger than document size");if(null!=t.slice){if(R===Y.SUBTYPE_BYTE_ARRAY){if((L=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<0)throw new w("Negative binary type element size found for subtype 0x02");if(L>D-4)throw new w("Binary type with subtype 0x02 contains too long binary size");if(L<D-4)throw new w("Binary type with subtype 0x02 contains too short binary size")}E=a&&l?t.slice(e,e+L):new Y(t.slice(e,e+L),R)}else{var $=b.alloc(L);if(R===Y.SUBTYPE_BYTE_ARRAY){if((L=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<0)throw new w("Negative binary type element size found for subtype 0x02");if(L>D-4)throw new w("Binary type with subtype 0x02 contains too long binary size");if(L<D-4)throw new w("Binary type with subtype 0x02 contains too short binary size")}for(v=0;v<L;v++)$[v]=t[e+v];E=a&&l?$:new Y($,R)}e+=L}else if(11===m&&!1===f){for(v=e;0!==t[v]&&v<t.length;)v++;if(v>=t.length)throw new w("Bad BSON Document: illegal CString");var M=t.toString("utf8",e,v);for(v=e=v+1;0!==t[v]&&v<t.length;)v++;if(v>=t.length)throw new w("Bad BSON Document: illegal CString");var P=t.toString("utf8",e,v);e=v+1;var k=new Array(P.length);for(v=0;v<P.length;v++)switch(P[v]){case"m":k[v]="m";break;case"s":k[v]="g";break;case"i":k[v]="i"}E=new RegExp(M,k.join(""))}else if(11===m&&!0===f){for(v=e;0!==t[v]&&v<t.length;)v++;if(v>=t.length)throw new w("Bad BSON Document: illegal CString");M=t.toString("utf8",e,v);for(v=e=v+1;0!==t[v]&&v<t.length;)v++;if(v>=t.length)throw new w("Bad BSON Document: illegal CString");P=t.toString("utf8",e,v);e=v+1,E=new wt(M,P)}else if(14===m){if((Z=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Z>t.length-e||0!==t[e+Z-1])throw new w("bad string length in bson");var C=Xt(t,e,e+Z-1);E=l?C:new St(C),e+=Z}else if(17===m){B=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,_=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;E=new Ot(B,_)}else if(255===m)E=new yt;else if(127===m)E=new gt;else if(13===m){if((Z=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Z>t.length-e||0!==t[e+Z-1])throw new w("bad string length in bson");var J=Xt(t,e,e+Z-1);E=i?o?Wt(J,Ht,g):Wt(J):new z(J),e+=Z}else if(15===m){var H=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;if(H<13)throw new w("code_w_scope total size shorter minimum expected length");if((Z=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Z>t.length-e||0!==t[e+Z-1])throw new w("bad string length in bson");J=Xt(t,e,e+Z-1),N=e+=Z;var q=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,K=Zt(t,N,n,!1);if(e+=q,H<8+q+Z)throw new w("code_w_scope total size is too short, truncating scope");if(H>8+q+Z)throw new w("code_w_scope total size is too long, clips outer document");i?(E=o?Wt(J,Ht,g):Wt(J)).scope=K:E=new z(J,K)}else{if(12!==m)throw new w("Detected unknown BSON type "+m.toString(16)+' for fieldname "'+S+'"');var Z;if((Z=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)<=0||Z>t.length-e||0!==t[e+Z-1])throw new w("bad string length in bson");if(!zt(t,e,e+Z-1))throw new w("Invalid UTF-8 string in BSON document");var W=t.toString("utf8",e,e+Z-1);e+=Z;var X=b.alloc(12);t.copy(X,0,e,e+12);O=new vt(X);e+=12,E=new V(W,O)}"__proto__"===S?Object.defineProperty(g,S,{value:E,writable:!0,enumerable:!0,configurable:!0}):g[S]=E}if(p!==e-c){if(r)throw new w("corrupt array bson");throw new w("corrupt object bson")}if(!d)return g;if(F(g)){var Q=Object.assign({},g);return delete Q.$ref,delete Q.$id,delete Q.$db,new V(g.$ref,g.$id,g.$db,Q)}return g}function Wt(t,e,n){return e?(null==e[t]&&(e[t]=new Function(t)),e[t].bind(n)):new Function(t)}function Xt(t,e,n){for(var r=t.toString("utf8",e,n),i=0;i<r.length;i++)if(65533===r.charCodeAt(i)){if(!zt(t,e,n))throw new w("Invalid UTF-8 string in BSON document");break}return r}function Gt(t,e,n,r,i,o){var s,u,f,a="big"===r,h=8*o-i-1,l=(1<<h)-1,c=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=a?o-1:0,y=a?-1:1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-s))<1&&(s--,f*=2),(e+=s+c>=1?p/f:p*Math.pow(2,1-c))*f>=2&&(s++,f/=2),s+c>=l?(u=0,s=l):s+c>=1?(u=(e*f-1)*Math.pow(2,i),s+=c):(u=e*Math.pow(2,c-1)*Math.pow(2,i),s=0)),isNaN(e)&&(u=0);i>=8;)t[n+g]=255&u,g+=y,u/=256,i-=8;for(s=s<<i|u,isNaN(e)&&(s+=8),h+=i;h>0;)t[n+g]=255&s,g+=y,s/=256,h-=8;t[n+g-y]|=128*d}var Qt=/\x00/,te=new Set(["$db","$ref","$id","$clusterTime"]);function ee(t,e,n,r,i){t[r++]=2;var o=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8");t[(r=r+o+1)-1]=0;var s=t.write(n,r+4,void 0,"utf8");return t[r+3]=s+1>>24&255,t[r+2]=s+1>>16&255,t[r+1]=s+1>>8&255,t[r]=s+1&255,r=r+4+s,t[r++]=0,r}function ne(t,e,n,r,i){Number.isInteger(n)&&n>=$t&&n<=Rt?(t[r++]=16,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=n>>16&255,t[r++]=n>>24&255):(t[r++]=1,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,Gt(t,n,r,"little",52,8),r+=8);return r}function re(t,e,n,r,i){return t[r++]=10,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,r}function ie(t,e,n,r,i){return t[r++]=8,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t[r++]=n?1:0,r}function oe(t,e,n,r,i){t[r++]=9,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=G.fromNumber(n.getTime()),s=o.getLowBits(),u=o.getHighBits();return t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,t[r++]=255&u,t[r++]=u>>8&255,t[r++]=u>>16&255,t[r++]=u>>24&255,r}function se(t,e,n,r,i){if(t[r++]=11,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,n.source&&null!=n.source.match(Qt))throw Error("value "+n.source+" must not contain null bytes");return r+=t.write(n.source,r,void 0,"utf8"),t[r++]=0,n.ignoreCase&&(t[r++]=105),n.global&&(t[r++]=115),n.multiline&&(t[r++]=109),t[r++]=0,r}function ue(t,e,n,r,i){if(t[r++]=11,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,null!=n.pattern.match(Qt))throw Error("pattern "+n.pattern+" must not contain null bytes");return r+=t.write(n.pattern,r,void 0,"utf8"),t[r++]=0,r+=t.write(n.options.split("").sort().join(""),r,void 0,"utf8"),t[r++]=0,r}function fe(t,e,n,r,i){return null===n?t[r++]=10:"MinKey"===n._bsontype?t[r++]=255:t[r++]=127,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,r}function ae(t,e,n,r,i){if(t[r++]=7,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,"string"==typeof n.id)t.write(n.id,r,void 0,"binary");else{if(!A(n.id))throw new S("object ["+JSON.stringify(n)+"] is not a valid ObjectId");t.set(n.id.subarray(0,12),r)}return r+12}function he(t,e,n,r,i){t[r++]=5,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=n.length;return t[r++]=255&o,t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255,t[r++]=0,t.set(R(n),r),r+=o}function le(t,e,n,r,i,o,s,u,f,a){void 0===i&&(i=!1),void 0===o&&(o=0),void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===f&&(f=!1),void 0===a&&(a=[]);for(var h=0;h<a.length;h++)if(a[h]===n)throw new w("cyclic dependency detected");a.push(n),t[r++]=Array.isArray(n)?4:3,r+=f?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var l=Se(t,n,i,r,o+1,s,u,a);return a.pop(),l}function ce(t,e,n,r,i){return t[r++]=19,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t.set(n.bytes.subarray(0,16),r),r+16}function pe(t,e,n,r,i){t[r++]="Long"===n._bsontype?18:17,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=n.getLowBits(),s=n.getHighBits();return t[r++]=255&o,t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255,t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,r}function ge(t,e,n,r,i){return n=n.valueOf(),t[r++]=16,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=n>>16&255,t[r++]=n>>24&255,r}function ye(t,e,n,r,i){return t[r++]=1,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0,Gt(t,n.value,r,"little",52,8),r+=8}function de(t,e,n,r,i,o,s){t[r++]=13,r+=s?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var u=B(n),f=t.write(u,r+4,void 0,"utf8")+1;return t[r]=255&f,t[r+1]=f>>8&255,t[r+2]=f>>16&255,t[r+3]=f>>24&255,r=r+4+f-1,t[r++]=0,r}function be(t,e,n,r,i,o,s,u,f){if(void 0===i&&(i=!1),void 0===o&&(o=0),void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===f&&(f=!1),n.scope&&"object"==typeof n.scope){t[r++]=15,r+=f?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var a=r,h="string"==typeof n.code?n.code:n.code.toString();r+=4;var l=t.write(h,r+4,void 0,"utf8")+1;t[r]=255&l,t[r+1]=l>>8&255,t[r+2]=l>>16&255,t[r+3]=l>>24&255,t[r+4+l-1]=0,r=r+l+4;var c=Se(t,n.scope,i,r,o+1,s,u);r=c-1;var p=c-a;t[a++]=255&p,t[a++]=p>>8&255,t[a++]=p>>16&255,t[a++]=p>>24&255,t[r++]=0}else{t[r++]=13,r+=f?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;h=n.code.toString();var g=t.write(h,r+4,void 0,"utf8")+1;t[r]=255&g,t[r+1]=g>>8&255,t[r+2]=g>>16&255,t[r+3]=g>>24&255,r=r+4+g-1,t[r++]=0}return r}function me(t,e,n,r,i){t[r++]=5,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=n.value(!0),s=n.position;return n.sub_type===Y.SUBTYPE_BYTE_ARRAY&&(s+=4),t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,t[r++]=n.sub_type,n.sub_type===Y.SUBTYPE_BYTE_ARRAY&&(s-=4,t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255),t.set(o,r),r+=n.position}function ve(t,e,n,r,i){t[r++]=14,r+=i?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var o=t.write(n.value,r+4,void 0,"utf8")+1;return t[r]=255&o,t[r+1]=o>>8&255,t[r+2]=o>>16&255,t[r+3]=o>>24&255,r=r+4+o-1,t[r++]=0,r}function we(t,e,n,r,i,o,s){t[r++]=3,r+=s?t.write(e,r,void 0,"ascii"):t.write(e,r,void 0,"utf8"),t[r++]=0;var u=r,f={$ref:n.collection||n.namespace,$id:n.oid};null!=n.db&&(f.$db=n.db);var a=Se(t,f=Object.assign(f,n.fields),!1,r,i+1,o),h=a-u;return t[u++]=255&h,t[u++]=h>>8&255,t[u++]=h>>16&255,t[u++]=h>>24&255,a}function Se(e,n,r,i,o,s,u,f){void 0===r&&(r=!1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===f&&(f=[]),i=i||0,(f=f||[]).push(n);var a,h=i+4;if(Array.isArray(n))for(var l=0;l<n.length;l++){var c=""+l;if((b=n[l])&&b.toBSON){if("function"!=typeof b.toBSON)throw new S("toBSON is not a function");b=b.toBSON()}if("string"==typeof b)h=ee(e,c,b,h,!0);else if("number"==typeof b)h=ne(e,c,b,h,!0);else{if("bigint"==typeof b)throw new S("Unsupported type BigInt, please use Decimal128");if("boolean"==typeof b)h=ie(e,c,b,h,!0);else if(b instanceof Date||T(b))h=oe(e,c,b,h,!0);else if(void 0===b)h=re(e,c,0,h,!0);else if(null===b)h=re(e,c,0,h,!0);else if("ObjectId"===b._bsontype||"ObjectID"===b._bsontype)h=ae(e,c,b,h,!0);else if(A(b))h=he(e,c,b,h,!0);else if(b instanceof RegExp||j(b))h=se(e,c,b,h,!0);else if("object"==typeof b&&null==b._bsontype)h=le(e,c,b,h,r,o,s,u,!0,f);else if("object"==typeof b&&Bt(b)&&"Decimal128"===b._bsontype)h=ce(e,c,b,h,!0);else if("Long"===b._bsontype||"Timestamp"===b._bsontype)h=pe(e,c,b,h,!0);else if("Double"===b._bsontype)h=ye(e,c,b,h,!0);else if("function"==typeof b&&s)h=de(e,c,b,h,0,0,!0);else if("Code"===b._bsontype)h=be(e,c,b,h,r,o,s,u,!0);else if("Binary"===b._bsontype)h=me(e,c,b,h,!0);else if("Symbol"===b._bsontype)h=ve(e,c,b,h,!0);else if("DBRef"===b._bsontype)h=we(e,c,b,h,o,s,!0);else if("BSONRegExp"===b._bsontype)h=ue(e,c,b,h,!0);else if("Int32"===b._bsontype)h=ge(e,c,b,h,!0);else if("MinKey"===b._bsontype||"MaxKey"===b._bsontype)h=fe(e,c,b,h,!0);else if(void 0!==b._bsontype)throw new S("Unrecognized or invalid _bsontype: "+b._bsontype)}}else if(n instanceof t.Map||(a=n,"[object Map]"===Object.prototype.toString.call(a)))for(var p=n.entries(),g=!1;!g;){var y=p.next();if(!(g=!!y.done)){c=y.value[0];var d=typeof(b=y.value[1]);if("string"==typeof c&&!te.has(c)){if(null!=c.match(Qt))throw Error("key "+c+" must not contain null bytes");if(r){if("$"===c[0])throw Error("key "+c+" must not start with '$'");if(~c.indexOf("."))throw Error("key "+c+" must not contain '.'")}}if("string"===d)h=ee(e,c,b,h);else if("number"===d)h=ne(e,c,b,h);else{if("bigint"===d||U(b)||I(b))throw new S("Unsupported type BigInt, please use Decimal128");if("boolean"===d)h=ie(e,c,b,h);else if(b instanceof Date||T(b))h=oe(e,c,b,h);else if(null===b||void 0===b&&!1===u)h=re(e,c,0,h);else if("ObjectId"===b._bsontype||"ObjectID"===b._bsontype)h=ae(e,c,b,h);else if(A(b))h=he(e,c,b,h);else if(b instanceof RegExp||j(b))h=se(e,c,b,h);else if("object"===d&&null==b._bsontype)h=le(e,c,b,h,r,o,s,u,!1,f);else if("object"===d&&"Decimal128"===b._bsontype)h=ce(e,c,b,h);else if("Long"===b._bsontype||"Timestamp"===b._bsontype)h=pe(e,c,b,h);else if("Double"===b._bsontype)h=ye(e,c,b,h);else if("Code"===b._bsontype)h=be(e,c,b,h,r,o,s,u);else if("function"==typeof b&&s)h=de(e,c,b,h,0,0,s);else if("Binary"===b._bsontype)h=me(e,c,b,h);else if("Symbol"===b._bsontype)h=ve(e,c,b,h);else if("DBRef"===b._bsontype)h=we(e,c,b,h,o,s);else if("BSONRegExp"===b._bsontype)h=ue(e,c,b,h);else if("Int32"===b._bsontype)h=ge(e,c,b,h);else if("MinKey"===b._bsontype||"MaxKey"===b._bsontype)h=fe(e,c,b,h);else if(void 0!==b._bsontype)throw new S("Unrecognized or invalid _bsontype: "+b._bsontype)}}}else{if(n.toBSON){if("function"!=typeof n.toBSON)throw new S("toBSON is not a function");if(null!=(n=n.toBSON())&&"object"!=typeof n)throw new S("toBSON function did not return an object")}for(var c in n){var b;if((b=n[c])&&b.toBSON){if("function"!=typeof b.toBSON)throw new S("toBSON is not a function");b=b.toBSON()}d=typeof b;if("string"==typeof c&&!te.has(c)){if(null!=c.match(Qt))throw Error("key "+c+" must not contain null bytes");if(r){if("$"===c[0])throw Error("key "+c+" must not start with '$'");if(~c.indexOf("."))throw Error("key "+c+" must not contain '.'")}}if("string"===d)h=ee(e,c,b,h);else if("number"===d)h=ne(e,c,b,h);else{if("bigint"===d)throw new S("Unsupported type BigInt, please use Decimal128");if("boolean"===d)h=ie(e,c,b,h);else if(b instanceof Date||T(b))h=oe(e,c,b,h);else if(void 0===b)!1===u&&(h=re(e,c,0,h));else if(null===b)h=re(e,c,0,h);else if("ObjectId"===b._bsontype||"ObjectID"===b._bsontype)h=ae(e,c,b,h);else if(A(b))h=he(e,c,b,h);else if(b instanceof RegExp||j(b))h=se(e,c,b,h);else if("object"===d&&null==b._bsontype)h=le(e,c,b,h,r,o,s,u,!1,f);else if("object"===d&&"Decimal128"===b._bsontype)h=ce(e,c,b,h);else if("Long"===b._bsontype||"Timestamp"===b._bsontype)h=pe(e,c,b,h);else if("Double"===b._bsontype)h=ye(e,c,b,h);else if("Code"===b._bsontype)h=be(e,c,b,h,r,o,s,u);else if("function"==typeof b&&s)h=de(e,c,b,h,0,0,s);else if("Binary"===b._bsontype)h=me(e,c,b,h);else if("Symbol"===b._bsontype)h=ve(e,c,b,h);else if("DBRef"===b._bsontype)h=we(e,c,b,h,o,s);else if("BSONRegExp"===b._bsontype)h=ue(e,c,b,h);else if("Int32"===b._bsontype)h=ge(e,c,b,h);else if("MinKey"===b._bsontype||"MaxKey"===b._bsontype)h=fe(e,c,b,h);else if(void 0!==b._bsontype)throw new S("Unrecognized or invalid _bsontype: "+b._bsontype)}}}f.pop(),e[h++]=0;var m=h-i;return e[i++]=255&m,e[i++]=m>>8&255,e[i++]=m>>16&255,e[i++]=m>>24&255,h}var Ee=17825792,Oe=b.alloc(Ee);function Be(t){Oe.length<t&&(Oe=b.alloc(t))}function _e(t,e){void 0===e&&(e={});var n="boolean"==typeof e.checkKeys&&e.checkKeys,r="boolean"==typeof e.serializeFunctions&&e.serializeFunctions,i="boolean"!=typeof e.ignoreUndefined||e.ignoreUndefined,o="number"==typeof e.minInternalBufferSize?e.minInternalBufferSize:Ee;Oe.length<o&&(Oe=b.alloc(o));var s=Se(Oe,t,n,0,0,r,i,[]),u=b.alloc(s);return Oe.copy(u,0,0,u.length),u}function Ne(t,e,n){void 0===n&&(n={});var r="boolean"==typeof n.checkKeys&&n.checkKeys,i="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,o="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,s="number"==typeof n.index?n.index:0,u=Se(Oe,t,r,0,0,i,o);return Oe.copy(e,s,0,u),s+u-1}function xe(t,e){return void 0===e&&(e={}),qt(t instanceof b?t:R(t),e)}function Ae(t,e){return void 0===e&&(e={}),Jt(t,"boolean"==typeof(e=e||{}).serializeFunctions&&e.serializeFunctions,"boolean"!=typeof e.ignoreUndefined||e.ignoreUndefined)}function Ue(t,e,n,r,i,o){for(var s=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},o),u=R(t),f=e,a=0;a<n;a++){var h=u[f]|u[f+1]<<8|u[f+2]<<16|u[f+3]<<24;s.index=f,r[i+a]=qt(u,s),f+=h}return f}var Ie={Binary:Y,Code:z,DBRef:V,Decimal128:lt,Double:ct,Int32:pt,Long:G,UUID:J,Map:t.Map,MaxKey:gt,MinKey:yt,ObjectId:vt,ObjectID:vt,BSONRegExp:wt,BSONSymbol:St,Timestamp:Ot,EJSON:t.EJSON,setInternalBufferSize:Be,serialize:_e,serializeWithBufferAndIndex:Ne,deserialize:xe,calculateObjectSize:Ae,deserializeStream:Ue,BSONError:w,BSONTypeError:S};return t.BSONError=w,t.BSONRegExp=wt,t.BSONSymbol=St,t.BSONTypeError=S,t.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,t.BSON_BINARY_SUBTYPE_COLUMN=7,t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BSON_BINARY_SUBTYPE_ENCRYPTED=6,t.BSON_BINARY_SUBTYPE_FUNCTION=1,t.BSON_BINARY_SUBTYPE_MD5=5,t.BSON_BINARY_SUBTYPE_USER_DEFINED=128,t.BSON_BINARY_SUBTYPE_UUID=3,t.BSON_BINARY_SUBTYPE_UUID_NEW=4,t.BSON_DATA_ARRAY=4,t.BSON_DATA_BINARY=5,t.BSON_DATA_BOOLEAN=8,t.BSON_DATA_CODE=13,t.BSON_DATA_CODE_W_SCOPE=15,t.BSON_DATA_DATE=9,t.BSON_DATA_DBPOINTER=12,t.BSON_DATA_DECIMAL128=19,t.BSON_DATA_INT=16,t.BSON_DATA_LONG=18,t.BSON_DATA_MAX_KEY=127,t.BSON_DATA_MIN_KEY=255,t.BSON_DATA_NULL=10,t.BSON_DATA_NUMBER=1,t.BSON_DATA_OBJECT=3,t.BSON_DATA_OID=7,t.BSON_DATA_REGEXP=11,t.BSON_DATA_STRING=2,t.BSON_DATA_SYMBOL=14,t.BSON_DATA_TIMESTAMP=17,t.BSON_DATA_UNDEFINED=6,t.BSON_INT32_MAX=Rt,t.BSON_INT32_MIN=$t,t.BSON_INT64_MAX=Mt,t.BSON_INT64_MIN=Pt,t.Binary=Y,t.Code=z,t.DBRef=V,t.Decimal128=lt,t.Double=ct,t.Int32=pt,t.Long=G,t.LongWithoutOverridesClass=Et,t.MaxKey=gt,t.MinKey=yt,t.ObjectID=vt,t.ObjectId=vt,t.Timestamp=Ot,t.UUID=J,t.calculateObjectSize=Ae,t.default=Ie,t.deserialize=xe,t.deserializeStream=Ue,t.serialize=_e,t.serializeWithBufferAndIndex=Ne,t.setInternalBufferSize=Be,Object.defineProperty(t,"__esModule",{value:!0}),t}({});